const fs = require('fs');
const gzipme = require('gzipme');
const outFolder = 'build/pa2';

function atob(str) {return Buffer.from(str, 'base64').toString('binary');}
const data = atob('ZHJ1bXNldCAwDQoNCjM1IE1UMzJEcnVtcy9tdDMyZHJ1bS0wLnBhdA0KMzYgTVQzMkRydW1zL210MzJkcnVtLTEucGF0DQozNyBNVDMyRHJ1bXMvbXQzMmRydW0tMi5wYXQNCjM4IE1UMzJEcnVtcy9tdDMyZHJ1bS0zLnBhdA0KMzkgTVQzMkRydW1zL210MzJkcnVtLTQucGF0DQo0MCBNVDMyRHJ1bXMvbXQzMmRydW0tNS5wYXQNCjQxIE1UMzJEcnVtcy9tdDMyZHJ1bS02LnBhdA0KNDIgTVQzMkRydW1zL210MzJkcnVtLTcucGF0DQo0MyBNVDMyRHJ1bXMvbXQzMmRydW0tOC5wYXQNCjQ0IE1UMzJEcnVtcy9tdDMyZHJ1bS05LnBhdA0KNDUgTVQzMkRydW1zL210MzJkcnVtLTEwLnBhdA0KNDYgTVQzMkRydW1zL210MzJkcnVtLTExLnBhdA0KNDcgTVQzMkRydW1zL210MzJkcnVtLTEyLnBhdA0KNDggTVQzMkRydW1zL210MzJkcnVtLTEzLnBhdA0KNDkgTVQzMkRydW1zL210MzJkcnVtLTE0LnBhdA0KNTAgTVQzMkRydW1zL210MzJkcnVtLTE1LnBhdA0KNTEgTVQzMkRydW1zL210MzJkcnVtLTE2LnBhdA0KNTIgTVQzMkRydW1zL210MzJkcnVtLTE3LnBhdA0KNTMgTVQzMkRydW1zL210MzJkcnVtLTE4LnBhdA0KNTQgTVQzMkRydW1zL210MzJkcnVtLTE5LnBhdA0KNTUgTVQzMkRydW1zL210MzJkcnVtLTIwLnBhdA0KNTYgTVQzMkRydW1zL210MzJkcnVtLTIxLnBhdA0KNTcgTVQzMkRydW1zL210MzJkcnVtLTIyLnBhdA0KNTggTVQzMkRydW1zL210MzJkcnVtLTIzLnBhdA0KNTkgTVQzMkRydW1zL210MzJkcnVtLTI0LnBhdA0KNjAgTVQzMkRydW1zL210MzJkcnVtLTI1LnBhdA0KNjEgTVQzMkRydW1zL210MzJkcnVtLTI2LnBhdA0KNjIgTVQzMkRydW1zL210MzJkcnVtLTI3LnBhdA0KNjMgTVQzMkRydW1zL210MzJkcnVtLTI4LnBhdA0KNjQgTVQzMkRydW1zL210MzJkcnVtLTI5LnBhdA0KNjUgTVQzMkRydW1zL210MzJkcnVtLTMwLnBhdA0KNjYgTVQzMkRydW1zL210MzJkcnVtLTMxLnBhdA0KNjcgTVQzMkRydW1zL210MzJkcnVtLTMyLnBhdA0KNjggTVQzMkRydW1zL210MzJkcnVtLTMzLnBhdA0KNjkgTVQzMkRydW1zL210MzJkcnVtLTM0LnBhdA0KNzAgTVQzMkRydW1zL210MzJkcnVtLTM1LnBhdA0KNzEgTVQzMkRydW1zL210MzJkcnVtLTM2LnBhdA0KNzIgTVQzMkRydW1zL210MzJkcnVtLTM3LnBhdA0KNzMgTVQzMkRydW1zL210MzJkcnVtLTM4LnBhdA0KNzQgTVQzMkRydW1zL210MzJkcnVtLTM5LnBhdA0KNzUgTVQzMkRydW1zL210MzJkcnVtLTQwLnBhdA0KNzYgTVQzMkRydW1zL210MzJkcnVtLTQxLnBhdA0KNzcgTVQzMkRydW1zL210MzJkcnVtLTQyLnBhdA0KNzggTVQzMkRydW1zL210MzJkcnVtLTQzLnBhdA0KNzkgTVQzMkRydW1zL210MzJkcnVtLTQ0LnBhdA0KODAgTVQzMkRydW1zL210MzJkcnVtLTQ1LnBhdA0KODEgTVQzMkRydW1zL210MzJkcnVtLTQ2LnBhdA0KDQpiYW5rIDANCg0KMCBhcmFjaG5vLTEyNy5wYXQNCjEgYXJhY2huby0xMjYucGF0DQoyIGFyYWNobm8tMTI1LnBhdA0KMyBhcmFjaG5vLTEyNC5wYXQNCjQgYXJhY2huby0xMjMucGF0DQo1IGFyYWNobm8tMTIyLnBhdA0KNiBhcmFjaG5vLTEyMS5wYXQNCjcgYXJhY2huby0xMjAucGF0DQo4IGFyYWNobm8tMTE5LnBhdA0KOSBhcmFjaG5vLTExOC5wYXQNCjEwIGFyYWNobm8tMTE3LnBhdA0KMTEgYXJhY2huby0xMTYucGF0DQoxMiBhcmFjaG5vLTExNS5wYXQNCjEzIGFyYWNobm8tMTE0LnBhdA0KMTQgYXJhY2huby0xMTMucGF0DQoxNSBhcmFjaG5vLTExMi5wYXQNCjE2IGFyYWNobm8tMTExLnBhdA0KMTcgYXJhY2huby0xMTAucGF0DQoxOCBhcmFjaG5vLTEwOS5wYXQNCjE5IGFyYWNobm8tMTA4LnBhdA0KMjAgYXJhY2huby0xMDcucGF0DQoyMSBhcmFjaG5vLTEwNi5wYXQNCjIyIGFyYWNobm8tMTA1LnBhdA0KMjMgYXJhY2huby0xMDQucGF0DQoyNCBhcmFjaG5vLTEwMy5wYXQNCjI1IGFyYWNobm8tMTAyLnBhdA0KMjYgYXJhY2huby0xMDEucGF0DQoyNyBhcmFjaG5vLTEwMC5wYXQNCjI4IGFyYWNobm8tOTkucGF0DQoyOSBhcmFjaG5vLTk4LnBhdA0KMzAgYXJhY2huby05Ny5wYXQNCjMxIGFyYWNobm8tOTYucGF0DQozMiBhcmFjaG5vLTk1LnBhdA0KMzMgYXJhY2huby05NC5wYXQNCjM0IGFyYWNobm8tOTMucGF0DQozNSBhcmFjaG5vLTkyLnBhdA0KMzYgYXJhY2huby05MS5wYXQNCjM3IGFyYWNobm8tOTAucGF0DQozOCBhcmFjaG5vLTg5LnBhdA0KMzkgYXJhY2huby04OC5wYXQNCjQwIGFyYWNobm8tODcucGF0DQo0MSBhcmFjaG5vLTg2LnBhdA0KNDIgYXJhY2huby04NS5wYXQNCjQzIGFyYWNobm8tODQucGF0DQo0NCBhcmFjaG5vLTgzLnBhdA0KNDUgYXJhY2huby04Mi5wYXQNCjQ2IGFyYWNobm8tODEucGF0DQo0NyBhcmFjaG5vLTgwLnBhdA0KNDggYXJhY2huby03OS5wYXQNCjQ5IGFyYWNobm8tNzgucGF0DQo1MCBhcmFjaG5vLTc3LnBhdA0KNTEgYXJhY2huby03Ni5wYXQNCjUyIGFyYWNobm8tNzUucGF0DQo1MyBhcmFjaG5vLTc0LnBhdA0KNTQgYXJhY2huby03My5wYXQNCjU1IGFyYWNobm8tNzIucGF0DQo1NiBhcmFjaG5vLTcxLnBhdA0KNTcgYXJhY2huby03MC5wYXQNCjU4IGFyYWNobm8tNjkucGF0DQo1OSBhcmFjaG5vLTY4LnBhdA0KNjAgYXJhY2huby02Ny5wYXQNCjYxIGFyYWNobm8tNjYucGF0DQo2MiBhcmFjaG5vLTY1LnBhdA0KNjMgYXJhY2huby02NC5wYXQNCjY0IGFyYWNobm8tNjMucGF0DQo2NSBhcmFjaG5vLTYyLnBhdA0KNjYgYXJhY2huby02MS5wYXQNCjY3IGFyYWNobm8tNjAucGF0DQo2OCBhcmFjaG5vLTU5LnBhdA0KNjkgYXJhY2huby01OC5wYXQNCjcwIGFyYWNobm8tNTcucGF0DQo3MSBhcmFjaG5vLTU2LnBhdA0KNzIgYXJhY2huby01NS5wYXQNCjczIGFyYWNobm8tNTQucGF0DQo3NCBhcmFjaG5vLTUzLnBhdA0KNzUgYXJhY2huby01Mi5wYXQNCjc2IGFyYWNobm8tNTEucGF0DQo3NyBhcmFjaG5vLTUwLnBhdA0KNzggYXJhY2huby00OS5wYXQNCjc5IGFyYWNobm8tNDgucGF0DQo4MCBhcmFjaG5vLTQ3LnBhdA0KODEgYXJhY2huby00Ni5wYXQNCjgyIGFyYWNobm8tNDUucGF0DQo4MyBhcmFjaG5vLTQ0LnBhdA0KODQgYXJhY2huby00My5wYXQNCjg1IGFyYWNobm8tNDIucGF0DQo4NiBhcmFjaG5vLTQxLnBhdA0KODcgYXJhY2huby00MC5wYXQNCjg4IGFyYWNobm8tMzkucGF0DQo4OSBhcmFjaG5vLTM4LnBhdA0KOTAgYXJhY2huby0zNy5wYXQNCjkxIGFyYWNobm8tMzYucGF0DQo5MiBhcmFjaG5vLTM1LnBhdA0KOTMgYXJhY2huby0zNC5wYXQNCjk0IGFyYWNobm8tMzMucGF0DQo5NSBhcmFjaG5vLTMyLnBhdA0KOTYgYXJhY2huby0zMS5wYXQNCjk3IGFyYWNobm8tMzAucGF0DQo5OCBhcmFjaG5vLTI5LnBhdA0KOTkgYXJhY2huby0yOC5wYXQNCjEwMCBhcmFjaG5vLTI3LnBhdA0KMTAxIGFyYWNobm8tMjYucGF0DQoxMDIgYXJhY2huby0yNS5wYXQNCjEwMyBhcmFjaG5vLTI0LnBhdA0KMTA0IGFyYWNobm8tMjMucGF0DQoxMDUgYXJhY2huby0yMi5wYXQNCjEwNiBhcmFjaG5vLTIxLnBhdA0KMTA3IGFyYWNobm8tMjAucGF0DQoxMDggYXJhY2huby0xOS5wYXQNCjEwOSBhcmFjaG5vLTE4LnBhdA0KMTEwIGFyYWNobm8tMTcucGF0DQoxMTEgYXJhY2huby0xNi5wYXQNCjExMiBhcmFjaG5vLTE1LnBhdA0KMTEzIGFyYWNobm8tMTQucGF0DQoxMTQgYXJhY2huby0xMy5wYXQNCjExNSBhcmFjaG5vLTEyLnBhdA0KMTE2IGFyYWNobm8tMTEucGF0DQoxMTcgYXJhY2huby0xMC5wYXQNCjExOCBhcmFjaG5vLTkucGF0DQoxMTkgYXJhY2huby04LnBhdA0KMTIwIGFyYWNobm8tNy5wYXQNCjEyMSBhcmFjaG5vLTYucGF0DQoxMjIgYXJhY2huby01LnBhdA0KMTIzIGFyYWNobm8tNC5wYXQNCjEyNCBhcmFjaG5vLTMucGF0DQoxMjUgYXJhY2huby0yLnBhdA0KMTI2IGFyYWNobm8tMS5wYXQNCjEyNyBhcmFjaG5vLTAucGF0DQo=');

if (fs.existsSync(outFolder)) fs.rmdirSync(outFolder, { recursive: true });
fs.mkdirSync(outFolder);

let data2 = data.replace(/^([0-9]+)\s+([^.]+)\.pat/mg, (m,patchNum,fileName) => {
	let newName = (fileName.startsWith('MT32D') ? 'd' : 't') + patchNum + '.pat';
	gzipme(`node_modules/MIDI-Player/pat/${fileName}.pat`,{mode:'best',output: `${outFolder}/${newName}`});
	return `${patchNum} ${newName}`
});

fs.writeFileSync('pats.cfg',data2);
