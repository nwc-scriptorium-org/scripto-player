(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
(function (process){(function (){
function useColors(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function formatArgs(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff),!this.useColors)return;const o="color: "+this.color;e.splice(1,0,o,"color: inherit");let t=0,C=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(t++,"%c"===e&&(C=t))}),e.splice(C,0,o)}function save(e){try{e?exports.storage.setItem("debug",e):exports.storage.removeItem("debug")}catch(e){}}function load(){let e;try{e=exports.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}function localstorage(){try{return localStorage}catch(e){}}exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.storage=localstorage(),exports.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],exports.log=console.debug||console.log||(()=>{}),module.exports=require("./common")(exports);const{formatters:formatters}=module.exports;formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}};

}).call(this)}).call(this,require('_process'))
},{"./common":2,"_process":5}],2:[function(require,module,exports){
function setup(e){function n(e){let r,o=null;function s(...e){if(!s.enabled)return;const t=s,o=Number(new Date),l=o-(r||o);t.diff=l,t.prev=r,t.curr=o,r=o,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,o)=>{if("%%"===r)return"%";i++;const s=n.formatters[o];if("function"==typeof s){const n=e[i];r=s.call(t,n),e.splice(i,1),i--}return r}),n.formatArgs.call(t,e),(t.log||n.log).apply(t,e)}return s.namespace=e,s.useColors=n.useColors(),s.color=n.selectColor(e),s.extend=t,s.destroy=n.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null===o?n.enabled(e):o,set:e=>{o=e}}),"function"==typeof n.init&&n.init(s),s}function t(e,t){const r=n(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},n.disable=function(){const e=[...n.names.map(r),...n.skips.map(r).map(e=>"-"+e)].join(",");return n.enable(""),e},n.enable=function(e){let t;n.save(e),n.names=[],n.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(t=0;t<o;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=require("ms"),n.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(t=>{n[t]=e[t]}),n.names=[],n.skips=[],n.formatters={},n.selectColor=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return n.colors[Math.abs(t)%n.colors.length]},n.enable(n.load()),n}module.exports=setup;

},{"ms":4}],3:[function(require,module,exports){
"use strict";var ReflectOwnKeys,R="object"==typeof Reflect?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var NumberIsNaN=Number.isNaN||function(e){return e!=e};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter,module.exports.once=once,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function _getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function _addListener(e,t,n,r){var i,s,o;if(checkListener(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=_getMaxListeners(e))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,ProcessEmitWarning(u)}return e}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=onceWrapper.bind(r);return i.listener=n,r.wrapFn=i,i}function _listeners(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?unwrapListeners(i):arrayClone(i,i.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function arrayClone(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function unwrapListeners(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function once(e,t){return new Promise(function(n,r){function i(){void 0!==s&&e.removeListener("error",s),n([].slice.call(arguments))}var s;"error"!==t&&(s=function(n){e.removeListener(t,i),r(n)},e.once("error",s)),e.once(t,i)})}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");defaultMaxListeners=e}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)ReflectApply(u,this,t);else{var v=u.length,a=arrayClone(u,v);for(n=0;n<v;++n)ReflectApply(a[n],this,t)}return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var n,r,i,s,o;if(checkListener(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():spliceOne(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};

},{}],4:[function(require,module,exports){
var s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d;function parse(e){if(!((e=String(e)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var a=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*y;case"weeks":case"week":case"w":return a*w;case"days":case"day":case"d":return a*d;case"hours":case"hour":case"hrs":case"hr":case"h":return a*h;case"minutes":case"minute":case"mins":case"min":case"m":return a*m;case"seconds":case"second":case"secs":case"sec":case"s":return a*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function fmtShort(e){var r=Math.abs(e);return r>=d?Math.round(e/d)+"d":r>=h?Math.round(e/h)+"h":r>=m?Math.round(e/m)+"m":r>=s?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){var r=Math.abs(e);return r>=d?plural(e,r,d,"day"):r>=h?plural(e,r,h,"hour"):r>=m?plural(e,r,m,"minute"):r>=s?plural(e,r,s,"second"):e+" ms"}function plural(s,e,r,a){var n=e>=1.5*r;return Math.round(s/r)+" "+a+(n?"s":"")}module.exports=function(s,e){e=e||{};var r=typeof s;if("string"===r&&s.length>0)return parse(s);if("number"===r&&isFinite(s))return e.long?fmtLong(s):fmtShort(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};

},{}],5:[function(require,module,exports){
var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],6:[function(require,module,exports){
const Debug=require("debug"),EventEmitter=require("events").EventEmitter,LibTimidity=require("./libtimidity"),debug=Debug("timidity"),debugVerbose=Debug("timidity:verbose"),TIMIDITY_CFG="drumset 0\r\n\r\n35 d35.pat\r\n36 d36.pat\r\n37 d37.pat\r\n38 d38.pat\r\n39 d39.pat\r\n40 d40.pat\r\n41 d41.pat\r\n42 d42.pat\r\n43 d43.pat\r\n44 d44.pat\r\n45 d45.pat\r\n46 d46.pat\r\n47 d47.pat\r\n48 d48.pat\r\n49 d49.pat\r\n50 d50.pat\r\n51 d51.pat\r\n52 d52.pat\r\n53 d53.pat\r\n54 d54.pat\r\n55 d55.pat\r\n56 d56.pat\r\n57 d57.pat\r\n58 d58.pat\r\n59 d59.pat\r\n60 d60.pat\r\n61 d61.pat\r\n62 d62.pat\r\n63 d63.pat\r\n64 d64.pat\r\n65 d65.pat\r\n66 d66.pat\r\n67 d67.pat\r\n68 d68.pat\r\n69 d69.pat\r\n70 d70.pat\r\n71 d71.pat\r\n72 d72.pat\r\n73 d73.pat\r\n74 d74.pat\r\n75 d75.pat\r\n76 d76.pat\r\n77 d77.pat\r\n78 d78.pat\r\n79 d79.pat\r\n80 d80.pat\r\n81 d81.pat\r\n\r\nbank 0\r\n\r\n0 t0.pat\r\n1 t1.pat\r\n2 t2.pat\r\n3 t3.pat\r\n4 t4.pat\r\n5 t5.pat\r\n6 t6.pat\r\n7 t7.pat\r\n8 t8.pat\r\n9 t9.pat\r\n10 t10.pat\r\n11 t11.pat\r\n12 t12.pat\r\n13 t13.pat\r\n14 t14.pat\r\n15 t15.pat\r\n16 t16.pat\r\n17 t17.pat\r\n18 t18.pat\r\n19 t19.pat\r\n20 t20.pat\r\n21 t21.pat\r\n22 t22.pat\r\n23 t23.pat\r\n24 t24.pat\r\n25 t25.pat\r\n26 t26.pat\r\n27 t27.pat\r\n28 t28.pat\r\n29 t29.pat\r\n30 t30.pat\r\n31 t31.pat\r\n32 t32.pat\r\n33 t33.pat\r\n34 t34.pat\r\n35 t35.pat\r\n36 t36.pat\r\n37 t37.pat\r\n38 t38.pat\r\n39 t39.pat\r\n40 t40.pat\r\n41 t41.pat\r\n42 t42.pat\r\n43 t43.pat\r\n44 t44.pat\r\n45 t45.pat\r\n46 t46.pat\r\n47 t47.pat\r\n48 t48.pat\r\n49 t49.pat\r\n50 t50.pat\r\n51 t51.pat\r\n52 t52.pat\r\n53 t53.pat\r\n54 t54.pat\r\n55 t55.pat\r\n56 t56.pat\r\n57 t57.pat\r\n58 t58.pat\r\n59 t59.pat\r\n60 t60.pat\r\n61 t61.pat\r\n62 t62.pat\r\n63 t63.pat\r\n64 t64.pat\r\n65 t65.pat\r\n66 t66.pat\r\n67 t67.pat\r\n68 t68.pat\r\n69 t69.pat\r\n70 t70.pat\r\n71 t71.pat\r\n72 t72.pat\r\n73 t73.pat\r\n74 t74.pat\r\n75 t75.pat\r\n76 t76.pat\r\n77 t77.pat\r\n78 t78.pat\r\n79 t79.pat\r\n80 t80.pat\r\n81 t81.pat\r\n82 t82.pat\r\n83 t83.pat\r\n84 t84.pat\r\n85 t85.pat\r\n86 t86.pat\r\n87 t87.pat\r\n88 t88.pat\r\n89 t89.pat\r\n90 t90.pat\r\n91 t91.pat\r\n92 t92.pat\r\n93 t93.pat\r\n94 t94.pat\r\n95 t95.pat\r\n96 t96.pat\r\n97 t97.pat\r\n98 t98.pat\r\n99 t99.pat\r\n100 t100.pat\r\n101 t101.pat\r\n102 t102.pat\r\n103 t103.pat\r\n104 t104.pat\r\n105 t105.pat\r\n106 t106.pat\r\n107 t107.pat\r\n108 t108.pat\r\n109 t109.pat\r\n110 t110.pat\r\n111 t111.pat\r\n112 t112.pat\r\n113 t113.pat\r\n114 t114.pat\r\n115 t115.pat\r\n116 t116.pat\r\n117 t117.pat\r\n118 t118.pat\r\n119 t119.pat\r\n120 t120.pat\r\n121 t121.pat\r\n122 t122.pat\r\n123 t123.pat\r\n124 t124.pat\r\n125 t125.pat\r\n126 t126.pat\r\n127 t127.pat\r\n",DEFAULT_SAMPLE_RATE=44100,AUDIO_FORMAT=32784,NUM_CHANNELS=2,BYTES_PER_SAMPLE=2*NUM_CHANNELS,BUFFER_SIZE=16384,AudioContext="undefined"!=typeof window&&(window.AudioContext||window.webkitAudioContext),defaultOptions={baseUrl:"https://cdn.noteworthycomposer.org/timidity/",patUrl:"pat/",config:TIMIDITY_CFG};class Timidity extends EventEmitter{constructor(t={}){let r=(t=Object.assign({},defaultOptions,t)).baseUrl,n=t.patUrl;super(),this.destroyed=!1,r.includes("//")||(r=new URL(r,window.location.origin).href),r.endsWith("/")||(r+="/"),this._baseUrl=r,n?n.includes("//")||(n=new URL(n,n.startsWith("/")?window.location.origin:r).href):n=`${r}/pat/`,n.endsWith("/")||(n+="/"),this._patUrl=n,this._config=t.config,this._ready=!1,this._lib=null,this._playing=!1,this._pendingFetches={},this._songPtr=0,this._bufferPtr=0,this._array=new Int16Array(2*BUFFER_SIZE),this._currentUrlOrBuf=null,this._interval=null,this._startInterval=this._startInterval.bind(this),this._stopInterval=this._stopInterval.bind(this),this._audioContext=new AudioContext,this._node=this._audioContext.createScriptProcessor(BUFFER_SIZE,0,NUM_CHANNELS),this._onAudioProcess=this._onAudioProcess.bind(this),this._node.addEventListener("audioprocess",this._onAudioProcess),this._node.connect(this._audioContext.destination),LibTimidity({locateFile:t=>new URL(t,this._baseUrl).href}).then(t=>this._onLibReady(t))}_onLibReady(t){if(this._lib=t,t.FS.writeFile("/timidity.cfg",this._config),0!==t._mid_init("/timidity.cfg"))return this._destroy(new Error("Failed to initialize libtimidity"));this._bufferPtr=t._malloc(BUFFER_SIZE*BYTES_PER_SAMPLE),debugVerbose("Initialized libtimidity"),this._ready=!0,this.emit("_ready")}async load(t){if(debug("load %o",t),this.destroyed)throw new Error("load() called after destroy()");if(this._audioContext.resume(),this._songPtr&&this._destroySong(),this.emit("unstarted"),this._stopInterval(),!this._ready)return this.once("_ready",()=>this.load(t));let r;if(this.emit("buffering"),this._currentUrlOrBuf=t,"string"==typeof t){if(r=await this._fetch(t),this._currentUrlOrBuf!==t)return}else{if(!(t instanceof Uint8Array))throw new Error("load() expects a `string` or `Uint8Array` argument");r=t}let n=this._loadSong(r),i=this._lib._mid_get_load_request_count(n);if(i>0){let e=this._getMissingInstruments(n,i);if(debugVerbose("Fetching instruments: %o",e),await Promise.all(e.map(t=>this._fetchInstrument(t))),this._currentUrlOrBuf!==t)return;this._lib._mid_song_free(n),n=this._loadSong(r),(i=this._lib._mid_get_load_request_count(n))>0&&(e=this._getMissingInstruments(n,i),debug("Playing with missing instruments: %o",e))}this._songPtr=n,this._lib._mid_song_start(this._songPtr),debugVerbose("Song and instruments are loaded")}_getMissingInstruments(t,r){const n=[];for(let i=0;i<r;i++){const r=this._lib._mid_get_load_request(t,i),e=this._lib.UTF8ToString(r);n.push(e)}return n}_loadSong(t){const r=this._lib._mid_alloc_options(this._audioContext.sampleRate||DEFAULT_SAMPLE_RATE,AUDIO_FORMAT,NUM_CHANNELS,BUFFER_SIZE),n=this._lib._malloc(t.byteLength);this._lib.HEAPU8.set(t,n);const i=this._lib._mid_istream_open_mem(n,t.byteLength),e=this._lib._mid_song_load(i,r);return this._lib._mid_istream_close(i),this._lib._free(r),this._lib._free(n),0===e?this._destroy(new Error("Failed to load MIDI file")):e}async _fetchInstrument(t){if(this._pendingFetches[t])return this._pendingFetches[t];const r=new URL(t,this._patUrl),n=this._fetch(r);this._pendingFetches[t]=n;const i=await n;return this._writeInstrumentFile(t,i),delete this._pendingFetches[t],i}_writeInstrumentFile(t,r){const n=t.split("/").slice(0,-1).join("/");this._mkdirp(n),this._lib.FS.writeFile(t,r,{encoding:"binary"})}_mkdirp(t){const r=t.split("/");let n="/";for(let t=0;t<r.length;t++){const i=r[t];try{this._lib.FS.mkdir(`${n}${i}`)}catch(t){}n+=`${i}/`}}async _fetch(t){const r=await window.fetch(t);if(200!==r.status)throw new Error(`Could not load ${t}`);const n=await r.arrayBuffer();return new Uint8Array(n)}play(){if(debug("play"),this.destroyed)throw new Error("play() called after destroy()");this._audioContext.resume(),this._playing=!0,this._ready&&!this._currentUrlOrBuf&&(this.emit("playing"),this._startInterval())}_onAudioProcess(t){const r=this._songPtr&&this._playing?this._readMidiData():0;r>0&&this._currentUrlOrBuf&&(this._currentUrlOrBuf=null,this.emit("playing"),this._startInterval());const n=t.outputBuffer.getChannelData(0),i=t.outputBuffer.getChannelData(1);for(let t=0;t<r;t++)n[t]=this._array[2*t]/32767,i[t]=this._array[2*t+1]/32767;for(let t=r;t<BUFFER_SIZE;t++)n[t]=0,i[t]=0;this._songPtr&&this._playing&&0===r&&(this.seek(0),this.pause(),this._lib._mid_song_start(this._songPtr),this.emit("ended"))}_readMidiData(){const t=this._lib._mid_song_read_wave(this._songPtr,this._bufferPtr,BUFFER_SIZE*BYTES_PER_SAMPLE),r=t/BYTES_PER_SAMPLE;return 0===r?0:(this._array.set(this._lib.HEAP16.subarray(this._bufferPtr/2,(this._bufferPtr+t)/2)),r)}pause(){if(debug("pause"),this.destroyed)throw new Error("pause() called after destroy()");this._playing=!1,this._stopInterval(),this.emit("paused")}seek(t){if(debug("seek %d",t),this.destroyed)throw new Error("seek() called after destroy()");if(!this._songPtr)return;const r=Math.floor(1e3*t);this._lib._mid_song_seek(this._songPtr,r),this._onTimeupdate()}get currentTime(){return this.destroyed||!this._songPtr?0:this._lib._mid_song_get_time(this._songPtr)/1e3}get duration(){return this.destroyed||!this._songPtr?1:this._lib._mid_song_get_total_time(this._songPtr)/1e3}_onTimeupdate(){this.emit("timeupdate",this.currentTime)}_startInterval(){this._onTimeupdate(),this._interval=setInterval(()=>this._onTimeupdate(),1e3)}_stopInterval(){this._onTimeupdate(),clearInterval(this._interval),this._interval=null}destroy(){if(debug("destroy"),this.destroyed)throw new Error("destroy() called after destroy()");this._destroy()}_destroy(t){this.destroyed||(this.destroyed=!0,this._stopInterval(),this._array=null,this._songPtr&&this._destroySong(),this._bufferPtr&&(this._lib._free(this._bufferPtr),this._bufferPtr=0),this._node&&(this._node.disconnect(),this._node.removeEventListener("audioprocess",this._onAudioProcess)),this._audioContext&&this._audioContext.close(),t&&this.emit("error",t),debug("destroyed (err %o)",t))}_destroySong(){this._lib._mid_song_free(this._songPtr),this._songPtr=0}}"object"==typeof module&&module.exports&&(module.exports=Timidity),"undefined"!=typeof window&&(window.Timidity=Timidity);

},{"./libtimidity":7,"debug":1,"events":3}],7:[function(require,module,exports){
var LibTimidity=function(){var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return function(r){var t,n,o=void 0!==(r=r||{})?r:{};o.ready=new Promise(function(e,r){t=e,n=r});var i,a={};for(i in o)o.hasOwnProperty(i)&&(a[i]=o[i]);var s,u,c=[],l=!0,f=!1,d="";(l||f)&&(f?d=self.location.href:"undefined"!=typeof document&&document.currentScript&&(d=document.currentScript.src),e&&(d=e),d=0!==d.indexOf("blob:")?d.substr(0,d.lastIndexOf("/")+1):"",s=function(e){var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},f&&(u=function(e){var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),function(e,r,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?r(n.response):t()},n.onerror=t,n.send(null)});var m=o.print||console.log.bind(console),p=o.printErr||console.warn.bind(console);for(i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);a=null,o.arguments&&(c=o.arguments),o.thisProgram&&o.thisProgram,o.quit&&o.quit;var h,w,v=16;o.wasmBinary&&(h=o.wasmBinary),o.noExitRuntime&&o.noExitRuntime,"object"!=typeof WebAssembly&&H("no native wasm support detected");var g=!1;var y="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(e,r,t){for(var n=r+t,o=r;e[o]&&!(o>=n);)++o;if(o-r>16&&e.subarray&&y)return y.decode(e.subarray(r,o));for(var i="";r<o;){var a=e[r++];if(128&a){var s=63&e[r++];if(192!=(224&a)){var u=63&e[r++];if((a=224==(240&a)?(15&a)<<12|s<<6|u:(7&a)<<18|s<<12|u<<6|63&e[r++])<65536)i+=String.fromCharCode(a);else{var c=a-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else i+=String.fromCharCode((31&a)<<6|s)}else i+=String.fromCharCode(a)}return i}function _(e,r){return e?E(S,e,r):""}function k(e,r,t,n){if(!(n>0))return 0;for(var o=t,i=t+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a);if(s<=127){if(t>=i)break;r[t++]=s}else if(s<=2047){if(t+1>=i)break;r[t++]=192|s>>6,r[t++]=128|63&s}else if(s<=65535){if(t+2>=i)break;r[t++]=224|s>>12,r[t++]=128|s>>6&63,r[t++]=128|63&s}else{if(t+3>=i)break;r[t++]=240|s>>18,r[t++]=128|s>>12&63,r[t++]=128|s>>6&63,r[t++]=128|63&s}}return r[t]=0,t-o}function b(e){for(var r=0,t=0;t<e.length;++t){var n=e.charCodeAt(t);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++t)),n<=127?++r:r+=n<=2047?2:n<=65535?3:4}return r}var D,F,S,P,A;function x(e){D=e,o.HEAP8=F=new Int8Array(e),o.HEAP16=P=new Int16Array(e),o.HEAP32=A=new Int32Array(e),o.HEAPU8=S=new Uint8Array(e),o.HEAPU16=new Uint16Array(e),o.HEAPU32=new Uint32Array(e),o.HEAPF32=new Float32Array(e),o.HEAPF64=new Float64Array(e)}var M,R=o.INITIAL_MEMORY||16777216;(w=o.wasmMemory?o.wasmMemory:new WebAssembly.Memory({initial:R/65536,maximum:32768}))&&(D=w.buffer),R=D.byteLength,x(D);var T=[],B=[],z=[],N=[];var L=0,O=null,j=null;function I(e){L++,o.monitorRunDependencies&&o.monitorRunDependencies(L)}function C(e){if(L--,o.monitorRunDependencies&&o.monitorRunDependencies(L),0==L&&(null!==O&&(clearInterval(O),O=null),j)){var r=j;j=null,r()}}function H(e){o.onAbort&&o.onAbort(e),p(e+=""),g=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var r=new WebAssembly.RuntimeError(e);throw n(r),r}o.preloadedImages={},o.preloadedAudios={};var q="data:application/octet-stream;base64,";function U(e){return r=e,t=q,String.prototype.startsWith?r.startsWith(t):0===r.indexOf(t);var r,t}var W,X,G,V="libtimidity.wasm";function K(){try{if(h)return new Uint8Array(h);if(u)return u(V);throw"both async and sync fetching of the wasm failed"}catch(e){H(e)}}function $(e){for(;e.length>0;){var r=e.shift();if("function"!=typeof r){var t=r.func;"number"==typeof t?void 0===r.arg?M.get(t)():M.get(t)(r.arg):t(void 0===r.arg?null:r.arg)}else r(o)}}function Y(){var e=function(){var e=new Error;if(!e.stack){try{throw new Error}catch(r){e=r}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}();return o.extraStackTrace&&(e+="\n"+o.extraStackTrace()),e.replace(/\b_Z[\w\d_]+/g,function(e){var r=e;return e===r?e:r+" ["+e+"]"})}function Z(e){return A[de()>>2]=e,e}U(V)||(W=V,V=o.locateFile?o.locateFile(W,d):d+W);var J={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,r){for(var t=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),t++):t&&(e.splice(n,1),t--)}if(r)for(;t;t--)e.unshift("..");return e},normalize:function(e){var r="/"===e.charAt(0),t="/"===e.substr(-1);return(e=J.normalizeArray(e.split("/").filter(function(e){return!!e}),!r).join("/"))||r||(e="."),e&&t&&(e+="/"),(r?"/":"")+e},dirname:function(e){var r=J.splitPath(e),t=r[0],n=r[1];return t||n?(n&&(n=n.substr(0,n.length-1)),t+n):"."},basename:function(e){if("/"===e)return"/";var r=(e=(e=J.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===r?e:e.substr(r+1)},extname:function(e){return J.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return J.normalize(e.join("/"))},join2:function(e,r){return J.normalize(e+"/"+r)}};var Q={resolve:function(){for(var e="",r=!1,t=arguments.length-1;t>=-1&&!r;t--){var n=t>=0?arguments[t]:ne.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,r="/"===n.charAt(0)}return(r?"/":"")+(e=J.normalizeArray(e.split("/").filter(function(e){return!!e}),!r).join("/"))||"."},relative:function(e,r){function t(e){for(var r=0;r<e.length&&""===e[r];r++);for(var t=e.length-1;t>=0&&""===e[t];t--);return r>t?[]:e.slice(r,t-r+1)}e=Q.resolve(e).substr(1),r=Q.resolve(r).substr(1);for(var n=t(e.split("/")),o=t(r.split("/")),i=Math.min(n.length,o.length),a=i,s=0;s<i;s++)if(n[s]!==o[s]){a=s;break}var u=[];for(s=a;s<n.length;s++)u.push("..");return(u=u.concat(o.slice(a))).join("/")}},ee={ttys:[],init:function(){},shutdown:function(){},register:function(e,r){ee.ttys[e]={input:[],output:[],ops:r},ne.registerDevice(e,ee.stream_ops)},stream_ops:{open:function(e){var r=ee.ttys[e.node.rdev];if(!r)throw new ne.ErrnoError(43);e.tty=r,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,r,t,n,o){if(!e.tty||!e.tty.ops.get_char)throw new ne.ErrnoError(60);for(var i=0,a=0;a<n;a++){var s;try{s=e.tty.ops.get_char(e.tty)}catch(e){throw new ne.ErrnoError(29)}if(void 0===s&&0===i)throw new ne.ErrnoError(6);if(null==s)break;i++,r[t+a]=s}return i&&(e.node.timestamp=Date.now()),i},write:function(e,r,t,n,o){if(!e.tty||!e.tty.ops.put_char)throw new ne.ErrnoError(60);try{for(var i=0;i<n;i++)e.tty.ops.put_char(e.tty,r[t+i])}catch(e){throw new ne.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),i}},default_tty_ops:{get_char:function(e){if(!e.input.length){var r=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(r=window.prompt("Input: "))&&(r+="\n"):"function"==typeof readline&&null!==(r=readline())&&(r+="\n"),!r)return null;e.input=se(r,!0)}return e.input.shift()},put_char:function(e,r){null===r||10===r?(m(E(e.output,0)),e.output=[]):0!=r&&e.output.push(r)},flush:function(e){e.output&&e.output.length>0&&(m(E(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,r){null===r||10===r?(p(E(e.output,0)),e.output=[]):0!=r&&e.output.push(r)},flush:function(e){e.output&&e.output.length>0&&(p(E(e.output,0)),e.output=[])}}};function re(e){for(var r=function(e,r){return r||(r=v),Math.ceil(e/r)*r}(e,16384),t=fe(r);e<r;)F[t+e++]=0;return t}var te={ops_table:null,mount:function(e){return te.createNode(null,"/",16895,0)},createNode:function(e,r,t,n){if(ne.isBlkdev(t)||ne.isFIFO(t))throw new ne.ErrnoError(63);te.ops_table||(te.ops_table={dir:{node:{getattr:te.node_ops.getattr,setattr:te.node_ops.setattr,lookup:te.node_ops.lookup,mknod:te.node_ops.mknod,rename:te.node_ops.rename,unlink:te.node_ops.unlink,rmdir:te.node_ops.rmdir,readdir:te.node_ops.readdir,symlink:te.node_ops.symlink},stream:{llseek:te.stream_ops.llseek}},file:{node:{getattr:te.node_ops.getattr,setattr:te.node_ops.setattr},stream:{llseek:te.stream_ops.llseek,read:te.stream_ops.read,write:te.stream_ops.write,allocate:te.stream_ops.allocate,mmap:te.stream_ops.mmap,msync:te.stream_ops.msync}},link:{node:{getattr:te.node_ops.getattr,setattr:te.node_ops.setattr,readlink:te.node_ops.readlink},stream:{}},chrdev:{node:{getattr:te.node_ops.getattr,setattr:te.node_ops.setattr},stream:ne.chrdev_stream_ops}});var o=ne.createNode(e,r,t,n);return ne.isDir(o.mode)?(o.node_ops=te.ops_table.dir.node,o.stream_ops=te.ops_table.dir.stream,o.contents={}):ne.isFile(o.mode)?(o.node_ops=te.ops_table.file.node,o.stream_ops=te.ops_table.file.stream,o.usedBytes=0,o.contents=null):ne.isLink(o.mode)?(o.node_ops=te.ops_table.link.node,o.stream_ops=te.ops_table.link.stream):ne.isChrdev(o.mode)&&(o.node_ops=te.ops_table.chrdev.node,o.stream_ops=te.ops_table.chrdev.stream),o.timestamp=Date.now(),e&&(e.contents[r]=o),o},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var r=[],t=0;t<e.usedBytes;++t)r.push(e.contents[t]);return r}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,r){var t=e.contents?e.contents.length:0;if(!(t>=r)){r=Math.max(r,t*(t<1048576?2:1.125)>>>0),0!=t&&(r=Math.max(r,256));var n=e.contents;e.contents=new Uint8Array(r),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,r){if(e.usedBytes!=r){if(0==r)return e.contents=null,void(e.usedBytes=0);if(!e.contents||e.contents.subarray){var t=e.contents;return e.contents=new Uint8Array(r),t&&e.contents.set(t.subarray(0,Math.min(r,e.usedBytes))),void(e.usedBytes=r)}if(e.contents||(e.contents=[]),e.contents.length>r)e.contents.length=r;else for(;e.contents.length<r;)e.contents.push(0);e.usedBytes=r}},node_ops:{getattr:function(e){var r={};return r.dev=ne.isChrdev(e.mode)?e.id:1,r.ino=e.id,r.mode=e.mode,r.nlink=1,r.uid=0,r.gid=0,r.rdev=e.rdev,ne.isDir(e.mode)?r.size=4096:ne.isFile(e.mode)?r.size=e.usedBytes:ne.isLink(e.mode)?r.size=e.link.length:r.size=0,r.atime=new Date(e.timestamp),r.mtime=new Date(e.timestamp),r.ctime=new Date(e.timestamp),r.blksize=4096,r.blocks=Math.ceil(r.size/r.blksize),r},setattr:function(e,r){void 0!==r.mode&&(e.mode=r.mode),void 0!==r.timestamp&&(e.timestamp=r.timestamp),void 0!==r.size&&te.resizeFileStorage(e,r.size)},lookup:function(e,r){throw ne.genericErrors[44]},mknod:function(e,r,t,n){return te.createNode(e,r,t,n)},rename:function(e,r,t){if(ne.isDir(e.mode)){var n;try{n=ne.lookupNode(r,t)}catch(e){}if(n)for(var o in n.contents)throw new ne.ErrnoError(55)}delete e.parent.contents[e.name],e.name=t,r.contents[t]=e,e.parent=r},unlink:function(e,r){delete e.contents[r]},rmdir:function(e,r){var t=ne.lookupNode(e,r);for(var n in t.contents)throw new ne.ErrnoError(55);delete e.contents[r]},readdir:function(e){var r=[".",".."];for(var t in e.contents)e.contents.hasOwnProperty(t)&&r.push(t);return r},symlink:function(e,r,t){var n=te.createNode(e,r,41471,0);return n.link=t,n},readlink:function(e){if(!ne.isLink(e.mode))throw new ne.ErrnoError(28);return e.link}},stream_ops:{read:function(e,r,t,n,o){var i=e.node.contents;if(o>=e.node.usedBytes)return 0;var a=Math.min(e.node.usedBytes-o,n);if(a>8&&i.subarray)r.set(i.subarray(o,o+a),t);else for(var s=0;s<a;s++)r[t+s]=i[o+s];return a},write:function(e,r,t,n,o,i){if(r.buffer===F.buffer&&(i=!1),!n)return 0;var a=e.node;if(a.timestamp=Date.now(),r.subarray&&(!a.contents||a.contents.subarray)){if(i)return a.contents=r.subarray(t,t+n),a.usedBytes=n,n;if(0===a.usedBytes&&0===o)return a.contents=r.slice(t,t+n),a.usedBytes=n,n;if(o+n<=a.usedBytes)return a.contents.set(r.subarray(t,t+n),o),n}if(te.expandFileStorage(a,o+n),a.contents.subarray&&r.subarray)a.contents.set(r.subarray(t,t+n),o);else for(var s=0;s<n;s++)a.contents[o+s]=r[t+s];return a.usedBytes=Math.max(a.usedBytes,o+n),n},llseek:function(e,r,t){var n=r;if(1===t?n+=e.position:2===t&&ne.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new ne.ErrnoError(28);return n},allocate:function(e,r,t){te.expandFileStorage(e.node,r+t),e.node.usedBytes=Math.max(e.node.usedBytes,r+t)},mmap:function(e,r,t,n,o,i){var a,s,u;if(0===r||H("Assertion failed: "+a),!ne.isFile(e.node.mode))throw new ne.ErrnoError(43);var c=e.node.contents;if(2&i||c.buffer!==D){if((n>0||n+t<c.length)&&(c=c.subarray?c.subarray(n,n+t):Array.prototype.slice.call(c,n,n+t)),u=!0,!(s=re(t)))throw new ne.ErrnoError(48);F.set(c,s)}else u=!1,s=c.byteOffset;return{ptr:s,allocated:u}},msync:function(e,r,t,n,o){if(!ne.isFile(e.node.mode))throw new ne.ErrnoError(43);if(2&o)return 0;te.stream_ops.write(e,r,0,n,t,!1);return 0}}},ne={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(e){if(!(e instanceof ne.ErrnoError))throw e+" : "+Y();return Z(e.errno)},lookupPath:function(e,r){if(r=r||{},!(e=Q.resolve(ne.cwd(),e)))return{path:"",node:null};var t={follow_mount:!0,recurse_count:0};for(var n in t)void 0===r[n]&&(r[n]=t[n]);if(r.recurse_count>8)throw new ne.ErrnoError(32);for(var o=J.normalizeArray(e.split("/").filter(function(e){return!!e}),!1),i=ne.root,a="/",s=0;s<o.length;s++){var u=s===o.length-1;if(u&&r.parent)break;if(i=ne.lookupNode(i,o[s]),a=J.join2(a,o[s]),ne.isMountpoint(i)&&(!u||u&&r.follow_mount)&&(i=i.mounted.root),!u||r.follow)for(var c=0;ne.isLink(i.mode);){var l=ne.readlink(a);if(a=Q.resolve(J.dirname(a),l),i=ne.lookupPath(a,{recurse_count:r.recurse_count}).node,c++>40)throw new ne.ErrnoError(32)}}return{path:a,node:i}},getPath:function(e){for(var r;;){if(ne.isRoot(e)){var t=e.mount.mountpoint;return r?"/"!==t[t.length-1]?t+"/"+r:t+r:t}r=r?e.name+"/"+r:e.name,e=e.parent}},hashName:function(e,r){for(var t=0,n=0;n<r.length;n++)t=(t<<5)-t+r.charCodeAt(n)|0;return(e+t>>>0)%ne.nameTable.length},hashAddNode:function(e){var r=ne.hashName(e.parent.id,e.name);e.name_next=ne.nameTable[r],ne.nameTable[r]=e},hashRemoveNode:function(e){var r=ne.hashName(e.parent.id,e.name);if(ne.nameTable[r]===e)ne.nameTable[r]=e.name_next;else for(var t=ne.nameTable[r];t;){if(t.name_next===e){t.name_next=e.name_next;break}t=t.name_next}},lookupNode:function(e,r){var t=ne.mayLookup(e);if(t)throw new ne.ErrnoError(t,e);for(var n=ne.hashName(e.id,r),o=ne.nameTable[n];o;o=o.name_next){var i=o.name;if(o.parent.id===e.id&&i===r)return o}return ne.lookup(e,r)},createNode:function(e,r,t,n){var o=new ne.FSNode(e,r,t,n);return ne.hashAddNode(o),o},destroyNode:function(e){ne.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768==(61440&e)},isDir:function(e){return 16384==(61440&e)},isLink:function(e){return 40960==(61440&e)},isChrdev:function(e){return 8192==(61440&e)},isBlkdev:function(e){return 24576==(61440&e)},isFIFO:function(e){return 4096==(61440&e)},isSocket:function(e){return 49152==(49152&e)},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var r=ne.flagModes[e];if(void 0===r)throw new Error("Unknown file open mode: "+e);return r},flagsToPermissionString:function(e){var r=["r","w","rw"][3&e];return 512&e&&(r+="w"),r},nodePermissions:function(e,r){return ne.ignorePermissions?0:(-1===r.indexOf("r")||292&e.mode)&&(-1===r.indexOf("w")||146&e.mode)&&(-1===r.indexOf("x")||73&e.mode)?0:2},mayLookup:function(e){var r=ne.nodePermissions(e,"x");return r||(e.node_ops.lookup?0:2)},mayCreate:function(e,r){try{ne.lookupNode(e,r);return 20}catch(e){}return ne.nodePermissions(e,"wx")},mayDelete:function(e,r,t){var n;try{n=ne.lookupNode(e,r)}catch(e){return e.errno}var o=ne.nodePermissions(e,"wx");if(o)return o;if(t){if(!ne.isDir(n.mode))return 54;if(ne.isRoot(n)||ne.getPath(n)===ne.cwd())return 10}else if(ne.isDir(n.mode))return 31;return 0},mayOpen:function(e,r){return e?ne.isLink(e.mode)?32:ne.isDir(e.mode)&&("r"!==ne.flagsToPermissionString(r)||512&r)?31:ne.nodePermissions(e,ne.flagsToPermissionString(r)):44},MAX_OPEN_FDS:4096,nextfd:function(e,r){e=e||0,r=r||ne.MAX_OPEN_FDS;for(var t=e;t<=r;t++)if(!ne.streams[t])return t;throw new ne.ErrnoError(33)},getStream:function(e){return ne.streams[e]},createStream:function(e,r,t){ne.FSStream||(ne.FSStream=function(){},ne.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}});var n=new ne.FSStream;for(var o in e)n[o]=e[o];e=n;var i=ne.nextfd(r,t);return e.fd=i,ne.streams[i]=e,e},closeStream:function(e){ne.streams[e]=null},chrdev_stream_ops:{open:function(e){var r=ne.getDevice(e.node.rdev);e.stream_ops=r.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new ne.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,r){return e<<8|r},registerDevice:function(e,r){ne.devices[e]={stream_ops:r}},getDevice:function(e){return ne.devices[e]},getMounts:function(e){for(var r=[],t=[e];t.length;){var n=t.pop();r.push(n),t.push.apply(t,n.mounts)}return r},syncfs:function(e,r){"function"==typeof e&&(r=e,e=!1),ne.syncFSRequests++,ne.syncFSRequests>1&&p("warning: "+ne.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var t=ne.getMounts(ne.root.mount),n=0;function o(e){return ne.syncFSRequests--,r(e)}function i(e){if(e)return i.errored?void 0:(i.errored=!0,o(e));++n>=t.length&&o(null)}t.forEach(function(r){if(!r.type.syncfs)return i(null);r.type.syncfs(r,e,i)})},mount:function(e,r,t){var n,o="/"===t,i=!t;if(o&&ne.root)throw new ne.ErrnoError(10);if(!o&&!i){var a=ne.lookupPath(t,{follow_mount:!1});if(t=a.path,n=a.node,ne.isMountpoint(n))throw new ne.ErrnoError(10);if(!ne.isDir(n.mode))throw new ne.ErrnoError(54)}var s={type:e,opts:r,mountpoint:t,mounts:[]},u=e.mount(s);return u.mount=s,s.root=u,o?ne.root=u:n&&(n.mounted=s,n.mount&&n.mount.mounts.push(s)),u},unmount:function(e){var r=ne.lookupPath(e,{follow_mount:!1});if(!ne.isMountpoint(r.node))throw new ne.ErrnoError(28);var t=r.node,n=t.mounted,o=ne.getMounts(n);Object.keys(ne.nameTable).forEach(function(e){for(var r=ne.nameTable[e];r;){var t=r.name_next;-1!==o.indexOf(r.mount)&&ne.destroyNode(r),r=t}}),t.mounted=null;var i=t.mount.mounts.indexOf(n);t.mount.mounts.splice(i,1)},lookup:function(e,r){return e.node_ops.lookup(e,r)},mknod:function(e,r,t){var n=ne.lookupPath(e,{parent:!0}).node,o=J.basename(e);if(!o||"."===o||".."===o)throw new ne.ErrnoError(28);var i=ne.mayCreate(n,o);if(i)throw new ne.ErrnoError(i);if(!n.node_ops.mknod)throw new ne.ErrnoError(63);return n.node_ops.mknod(n,o,r,t)},create:function(e,r){return r=void 0!==r?r:438,r&=4095,r|=32768,ne.mknod(e,r,0)},mkdir:function(e,r){return r=void 0!==r?r:511,r&=1023,r|=16384,ne.mknod(e,r,0)},mkdirTree:function(e,r){for(var t=e.split("/"),n="",o=0;o<t.length;++o)if(t[o]){n+="/"+t[o];try{ne.mkdir(n,r)}catch(e){if(20!=e.errno)throw e}}},mkdev:function(e,r,t){return void 0===t&&(t=r,r=438),r|=8192,ne.mknod(e,r,t)},symlink:function(e,r){if(!Q.resolve(e))throw new ne.ErrnoError(44);var t=ne.lookupPath(r,{parent:!0}).node;if(!t)throw new ne.ErrnoError(44);var n=J.basename(r),o=ne.mayCreate(t,n);if(o)throw new ne.ErrnoError(o);if(!t.node_ops.symlink)throw new ne.ErrnoError(63);return t.node_ops.symlink(t,n,e)},rename:function(e,r){var t,n,o=J.dirname(e),i=J.dirname(r),a=J.basename(e),s=J.basename(r);if(t=ne.lookupPath(e,{parent:!0}).node,n=ne.lookupPath(r,{parent:!0}).node,!t||!n)throw new ne.ErrnoError(44);if(t.mount!==n.mount)throw new ne.ErrnoError(75);var u,c=ne.lookupNode(t,a),l=Q.relative(e,i);if("."!==l.charAt(0))throw new ne.ErrnoError(28);if("."!==(l=Q.relative(r,o)).charAt(0))throw new ne.ErrnoError(55);try{u=ne.lookupNode(n,s)}catch(e){}if(c!==u){var f=ne.isDir(c.mode),d=ne.mayDelete(t,a,f);if(d)throw new ne.ErrnoError(d);if(d=u?ne.mayDelete(n,s,f):ne.mayCreate(n,s))throw new ne.ErrnoError(d);if(!t.node_ops.rename)throw new ne.ErrnoError(63);if(ne.isMountpoint(c)||u&&ne.isMountpoint(u))throw new ne.ErrnoError(10);if(n!==t&&(d=ne.nodePermissions(t,"w")))throw new ne.ErrnoError(d);try{ne.trackingDelegate.willMovePath&&ne.trackingDelegate.willMovePath(e,r)}catch(t){p("FS.trackingDelegate['willMovePath']('"+e+"', '"+r+"') threw an exception: "+t.message)}ne.hashRemoveNode(c);try{t.node_ops.rename(c,n,s)}catch(e){throw e}finally{ne.hashAddNode(c)}try{ne.trackingDelegate.onMovePath&&ne.trackingDelegate.onMovePath(e,r)}catch(t){p("FS.trackingDelegate['onMovePath']('"+e+"', '"+r+"') threw an exception: "+t.message)}}},rmdir:function(e){var r=ne.lookupPath(e,{parent:!0}).node,t=J.basename(e),n=ne.lookupNode(r,t),o=ne.mayDelete(r,t,!0);if(o)throw new ne.ErrnoError(o);if(!r.node_ops.rmdir)throw new ne.ErrnoError(63);if(ne.isMountpoint(n))throw new ne.ErrnoError(10);try{ne.trackingDelegate.willDeletePath&&ne.trackingDelegate.willDeletePath(e)}catch(r){p("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+r.message)}r.node_ops.rmdir(r,t),ne.destroyNode(n);try{ne.trackingDelegate.onDeletePath&&ne.trackingDelegate.onDeletePath(e)}catch(r){p("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+r.message)}},readdir:function(e){var r=ne.lookupPath(e,{follow:!0}).node;if(!r.node_ops.readdir)throw new ne.ErrnoError(54);return r.node_ops.readdir(r)},unlink:function(e){var r=ne.lookupPath(e,{parent:!0}).node,t=J.basename(e),n=ne.lookupNode(r,t),o=ne.mayDelete(r,t,!1);if(o)throw new ne.ErrnoError(o);if(!r.node_ops.unlink)throw new ne.ErrnoError(63);if(ne.isMountpoint(n))throw new ne.ErrnoError(10);try{ne.trackingDelegate.willDeletePath&&ne.trackingDelegate.willDeletePath(e)}catch(r){p("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+r.message)}r.node_ops.unlink(r,t),ne.destroyNode(n);try{ne.trackingDelegate.onDeletePath&&ne.trackingDelegate.onDeletePath(e)}catch(r){p("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+r.message)}},readlink:function(e){var r=ne.lookupPath(e).node;if(!r)throw new ne.ErrnoError(44);if(!r.node_ops.readlink)throw new ne.ErrnoError(28);return Q.resolve(ne.getPath(r.parent),r.node_ops.readlink(r))},stat:function(e,r){var t=ne.lookupPath(e,{follow:!r}).node;if(!t)throw new ne.ErrnoError(44);if(!t.node_ops.getattr)throw new ne.ErrnoError(63);return t.node_ops.getattr(t)},lstat:function(e){return ne.stat(e,!0)},chmod:function(e,r,t){var n;"string"==typeof e?n=ne.lookupPath(e,{follow:!t}).node:n=e;if(!n.node_ops.setattr)throw new ne.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&r|-4096&n.mode,timestamp:Date.now()})},lchmod:function(e,r){ne.chmod(e,r,!0)},fchmod:function(e,r){var t=ne.getStream(e);if(!t)throw new ne.ErrnoError(8);ne.chmod(t.node,r)},chown:function(e,r,t,n){var o;"string"==typeof e?o=ne.lookupPath(e,{follow:!n}).node:o=e;if(!o.node_ops.setattr)throw new ne.ErrnoError(63);o.node_ops.setattr(o,{timestamp:Date.now()})},lchown:function(e,r,t){ne.chown(e,r,t,!0)},fchown:function(e,r,t){var n=ne.getStream(e);if(!n)throw new ne.ErrnoError(8);ne.chown(n.node,r,t)},truncate:function(e,r){if(r<0)throw new ne.ErrnoError(28);var t;"string"==typeof e?t=ne.lookupPath(e,{follow:!0}).node:t=e;if(!t.node_ops.setattr)throw new ne.ErrnoError(63);if(ne.isDir(t.mode))throw new ne.ErrnoError(31);if(!ne.isFile(t.mode))throw new ne.ErrnoError(28);var n=ne.nodePermissions(t,"w");if(n)throw new ne.ErrnoError(n);t.node_ops.setattr(t,{size:r,timestamp:Date.now()})},ftruncate:function(e,r){var t=ne.getStream(e);if(!t)throw new ne.ErrnoError(8);if(0==(2097155&t.flags))throw new ne.ErrnoError(28);ne.truncate(t.node,r)},utime:function(e,r,t){var n=ne.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(r,t)})},open:function(e,r,t,n,i){if(""===e)throw new ne.ErrnoError(44);var a;if(t=void 0===t?438:t,t=64&(r="string"==typeof r?ne.modeStringToFlags(r):r)?4095&t|32768:0,"object"==typeof e)a=e;else{e=J.normalize(e);try{a=ne.lookupPath(e,{follow:!(131072&r)}).node}catch(e){}}var s=!1;if(64&r)if(a){if(128&r)throw new ne.ErrnoError(20)}else a=ne.mknod(e,t,0),s=!0;if(!a)throw new ne.ErrnoError(44);if(ne.isChrdev(a.mode)&&(r&=-513),65536&r&&!ne.isDir(a.mode))throw new ne.ErrnoError(54);if(!s){var u=ne.mayOpen(a,r);if(u)throw new ne.ErrnoError(u)}512&r&&ne.truncate(a,0),r&=-131713;var c=ne.createStream({node:a,path:ne.getPath(a),flags:r,seekable:!0,position:0,stream_ops:a.stream_ops,ungotten:[],error:!1},n,i);c.stream_ops.open&&c.stream_ops.open(c),!o.logReadFiles||1&r||(ne.readFiles||(ne.readFiles={}),e in ne.readFiles||(ne.readFiles[e]=1,p("FS.trackingDelegate error on read file: "+e)));try{if(ne.trackingDelegate.onOpenFile){var l=0;1!=(2097155&r)&&(l|=ne.tracking.openFlags.READ),0!=(2097155&r)&&(l|=ne.tracking.openFlags.WRITE),ne.trackingDelegate.onOpenFile(e,l)}}catch(r){p("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+r.message)}return c},close:function(e){if(ne.isClosed(e))throw new ne.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{ne.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,r,t){if(ne.isClosed(e))throw new ne.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new ne.ErrnoError(70);if(0!=t&&1!=t&&2!=t)throw new ne.ErrnoError(28);return e.position=e.stream_ops.llseek(e,r,t),e.ungotten=[],e.position},read:function(e,r,t,n,o){if(n<0||o<0)throw new ne.ErrnoError(28);if(ne.isClosed(e))throw new ne.ErrnoError(8);if(1==(2097155&e.flags))throw new ne.ErrnoError(8);if(ne.isDir(e.node.mode))throw new ne.ErrnoError(31);if(!e.stream_ops.read)throw new ne.ErrnoError(28);var i=void 0!==o;if(i){if(!e.seekable)throw new ne.ErrnoError(70)}else o=e.position;var a=e.stream_ops.read(e,r,t,n,o);return i||(e.position+=a),a},write:function(e,r,t,n,o,i){if(n<0||o<0)throw new ne.ErrnoError(28);if(ne.isClosed(e))throw new ne.ErrnoError(8);if(0==(2097155&e.flags))throw new ne.ErrnoError(8);if(ne.isDir(e.node.mode))throw new ne.ErrnoError(31);if(!e.stream_ops.write)throw new ne.ErrnoError(28);e.seekable&&1024&e.flags&&ne.llseek(e,0,2);var a=void 0!==o;if(a){if(!e.seekable)throw new ne.ErrnoError(70)}else o=e.position;var s=e.stream_ops.write(e,r,t,n,o,i);a||(e.position+=s);try{e.path&&ne.trackingDelegate.onWriteToFile&&ne.trackingDelegate.onWriteToFile(e.path)}catch(r){p("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+r.message)}return s},allocate:function(e,r,t){if(ne.isClosed(e))throw new ne.ErrnoError(8);if(r<0||t<=0)throw new ne.ErrnoError(28);if(0==(2097155&e.flags))throw new ne.ErrnoError(8);if(!ne.isFile(e.node.mode)&&!ne.isDir(e.node.mode))throw new ne.ErrnoError(43);if(!e.stream_ops.allocate)throw new ne.ErrnoError(138);e.stream_ops.allocate(e,r,t)},mmap:function(e,r,t,n,o,i){if(0!=(2&o)&&0==(2&i)&&2!=(2097155&e.flags))throw new ne.ErrnoError(2);if(1==(2097155&e.flags))throw new ne.ErrnoError(2);if(!e.stream_ops.mmap)throw new ne.ErrnoError(43);return e.stream_ops.mmap(e,r,t,n,o,i)},msync:function(e,r,t,n,o){return e&&e.stream_ops.msync?e.stream_ops.msync(e,r,t,n,o):0},munmap:function(e){return 0},ioctl:function(e,r,t){if(!e.stream_ops.ioctl)throw new ne.ErrnoError(59);return e.stream_ops.ioctl(e,r,t)},readFile:function(e,r){if((r=r||{}).flags=r.flags||"r",r.encoding=r.encoding||"binary","utf8"!==r.encoding&&"binary"!==r.encoding)throw new Error('Invalid encoding type "'+r.encoding+'"');var t,n=ne.open(e,r.flags),o=ne.stat(e).size,i=new Uint8Array(o);return ne.read(n,i,0,o,0),"utf8"===r.encoding?t=E(i,0):"binary"===r.encoding&&(t=i),ne.close(n),t},writeFile:function(e,r,t){(t=t||{}).flags=t.flags||"w";var n=ne.open(e,t.flags,t.mode);if("string"==typeof r){var o=new Uint8Array(b(r)+1),i=k(r,o,0,o.length);ne.write(n,o,0,i,void 0,t.canOwn)}else{if(!ArrayBuffer.isView(r))throw new Error("Unsupported data type");ne.write(n,r,0,r.byteLength,void 0,t.canOwn)}ne.close(n)},cwd:function(){return ne.currentPath},chdir:function(e){var r=ne.lookupPath(e,{follow:!0});if(null===r.node)throw new ne.ErrnoError(44);if(!ne.isDir(r.node.mode))throw new ne.ErrnoError(54);var t=ne.nodePermissions(r.node,"x");if(t)throw new ne.ErrnoError(t);ne.currentPath=r.path},createDefaultDirectories:function(){ne.mkdir("/tmp"),ne.mkdir("/home"),ne.mkdir("/home/web_user")},createDefaultDevices:function(){ne.mkdir("/dev"),ne.registerDevice(ne.makedev(1,3),{read:function(){return 0},write:function(e,r,t,n,o){return n}}),ne.mkdev("/dev/null",ne.makedev(1,3)),ee.register(ne.makedev(5,0),ee.default_tty_ops),ee.register(ne.makedev(6,0),ee.default_tty1_ops),ne.mkdev("/dev/tty",ne.makedev(5,0)),ne.mkdev("/dev/tty1",ne.makedev(6,0));var e=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}return function(){H("randomDevice")}}();ne.createDevice("/dev","random",e),ne.createDevice("/dev","urandom",e),ne.mkdir("/dev/shm"),ne.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){ne.mkdir("/proc"),ne.mkdir("/proc/self"),ne.mkdir("/proc/self/fd"),ne.mount({mount:function(){var e=ne.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(e,r){var t=+r,n=ne.getStream(t);if(!n)throw new ne.ErrnoError(8);var o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return n.path}}};return o.parent=o,o}},e}},{},"/proc/self/fd")},createStandardStreams:function(){o.stdin?ne.createDevice("/dev","stdin",o.stdin):ne.symlink("/dev/tty","/dev/stdin"),o.stdout?ne.createDevice("/dev","stdout",null,o.stdout):ne.symlink("/dev/tty","/dev/stdout"),o.stderr?ne.createDevice("/dev","stderr",null,o.stderr):ne.symlink("/dev/tty1","/dev/stderr");ne.open("/dev/stdin","r"),ne.open("/dev/stdout","w"),ne.open("/dev/stderr","w")},ensureErrnoError:function(){ne.ErrnoError||(ne.ErrnoError=function(e,r){this.node=r,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},ne.ErrnoError.prototype=new Error,ne.ErrnoError.prototype.constructor=ne.ErrnoError,[44].forEach(function(e){ne.genericErrors[e]=new ne.ErrnoError(e),ne.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:function(){ne.ensureErrnoError(),ne.nameTable=new Array(4096),ne.mount(te,{},"/"),ne.createDefaultDirectories(),ne.createDefaultDevices(),ne.createSpecialDirectories(),ne.filesystems={MEMFS:te}},init:function(e,r,t){ne.init.initialized=!0,ne.ensureErrnoError(),o.stdin=e||o.stdin,o.stdout=r||o.stdout,o.stderr=t||o.stderr,ne.createStandardStreams()},quit:function(){ne.init.initialized=!1;var e=o._fflush;e&&e(0);for(var r=0;r<ne.streams.length;r++){var t=ne.streams[r];t&&ne.close(t)}},getMode:function(e,r){var t=0;return e&&(t|=365),r&&(t|=146),t},findObject:function(e,r){var t=ne.analyzePath(e,r);return t.exists?t.object:(Z(t.error),null)},analyzePath:function(e,r){try{e=(n=ne.lookupPath(e,{follow:!r})).path}catch(e){}var t={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=ne.lookupPath(e,{parent:!0});t.parentExists=!0,t.parentPath=n.path,t.parentObject=n.node,t.name=J.basename(e),n=ne.lookupPath(e,{follow:!r}),t.exists=!0,t.path=n.path,t.object=n.node,t.name=n.node.name,t.isRoot="/"===n.path}catch(e){t.error=e.errno}return t},createPath:function(e,r,t,n){e="string"==typeof e?e:ne.getPath(e);for(var o=r.split("/").reverse();o.length;){var i=o.pop();if(i){var a=J.join2(e,i);try{ne.mkdir(a)}catch(e){}e=a}}return a},createFile:function(e,r,t,n,o){var i=J.join2("string"==typeof e?e:ne.getPath(e),r),a=ne.getMode(n,o);return ne.create(i,a)},createDataFile:function(e,r,t,n,o,i){var a=r?J.join2("string"==typeof e?e:ne.getPath(e),r):e,s=ne.getMode(n,o),u=ne.create(a,s);if(t){if("string"==typeof t){for(var c=new Array(t.length),l=0,f=t.length;l<f;++l)c[l]=t.charCodeAt(l);t=c}ne.chmod(u,146|s);var d=ne.open(u,"w");ne.write(d,t,0,t.length,0,i),ne.close(d),ne.chmod(u,s)}return u},createDevice:function(e,r,t,n){var o=J.join2("string"==typeof e?e:ne.getPath(e),r),i=ne.getMode(!!t,!!n);ne.createDevice.major||(ne.createDevice.major=64);var a=ne.makedev(ne.createDevice.major++,0);return ne.registerDevice(a,{open:function(e){e.seekable=!1},close:function(e){n&&n.buffer&&n.buffer.length&&n(10)},read:function(e,r,n,o,i){for(var a=0,s=0;s<o;s++){var u;try{u=t()}catch(e){throw new ne.ErrnoError(29)}if(void 0===u&&0===a)throw new ne.ErrnoError(6);if(null==u)break;a++,r[n+s]=u}return a&&(e.node.timestamp=Date.now()),a},write:function(e,r,t,o,i){for(var a=0;a<o;a++)try{n(r[t+a])}catch(e){throw new ne.ErrnoError(29)}return o&&(e.node.timestamp=Date.now()),a}}),ne.mkdev(o,i,a)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var r=!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!s)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=se(s(e.url),!0),e.usedBytes=e.contents.length}catch(e){r=!1}return r||Z(29),r},createLazyFile:function(e,r,t,n,o){function i(){this.lengthKnown=!1,this.chunks=[]}if(i.prototype.get=function(e){if(!(e>this.length-1||e<0)){var r=e%this.chunkSize,t=e/this.chunkSize|0;return this.getter(t)[r]}},i.prototype.setDataGetter=function(e){this.getter=e},i.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",t,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+t+". Status: "+e.status);var r,n=Number(e.getResponseHeader("Content-length")),o=(r=e.getResponseHeader("Accept-Ranges"))&&"bytes"===r,i=(r=e.getResponseHeader("Content-Encoding"))&&"gzip"===r,a=1048576;o||(a=n);var s=this;s.setDataGetter(function(e){var r=e*a,o=(e+1)*a-1;if(o=Math.min(o,n-1),void 0===s.chunks[e]&&(s.chunks[e]=function(e,r){if(e>r)throw new Error("invalid range ("+e+", "+r+") or no bytes requested!");if(r>n-1)throw new Error("only "+n+" bytes available! programmer error!");var o=new XMLHttpRequest;if(o.open("GET",t,!1),n!==a&&o.setRequestHeader("Range","bytes="+e+"-"+r),"undefined"!=typeof Uint8Array&&(o.responseType="arraybuffer"),o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null),!(o.status>=200&&o.status<300||304===o.status))throw new Error("Couldn't load "+t+". Status: "+o.status);return void 0!==o.response?new Uint8Array(o.response||[]):se(o.responseText||"",!0)}(r,o)),void 0===s.chunks[e])throw new Error("doXHR failed!");return s.chunks[e]}),!i&&n||(a=n=1,n=this.getter(0).length,a=n,m("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=a,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!f)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var a=new i;Object.defineProperties(a,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var s={isDevice:!1,contents:a}}else s={isDevice:!1,url:t};var u=ne.createFile(e,r,s,n,o);s.contents?u.contents=s.contents:s.url&&(u.contents=null,u.url=s.url),Object.defineProperties(u,{usedBytes:{get:function(){return this.contents.length}}});var c={};return Object.keys(u.stream_ops).forEach(function(e){var r=u.stream_ops[e];c[e]=function(){if(!ne.forceLoadFile(u))throw new ne.ErrnoError(29);return r.apply(null,arguments)}}),c.read=function(e,r,t,n,o){if(!ne.forceLoadFile(u))throw new ne.ErrnoError(29);var i=e.node.contents;if(o>=i.length)return 0;var a=Math.min(i.length-o,n);if(i.slice)for(var s=0;s<a;s++)r[t+s]=i[o+s];else for(s=0;s<a;s++)r[t+s]=i.get(o+s);return a},u.stream_ops=c,u},createPreloadedFile:function(e,r,t,n,i,a,s,u,c,l){Browser.init();var f=r?Q.resolve(J.join2(e,r)):e;function d(t){function d(t){l&&l(),u||ne.createDataFile(e,r,t,n,i,c),a&&a(),C()}var m=!1;o.preloadPlugins.forEach(function(e){m||e.canHandle(f)&&(e.handle(t,f,d,function(){s&&s(),C()}),m=!0)}),m||d(t)}I(),"string"==typeof t?Browser.asyncLoad(t,function(e){d(e)},s):d(t)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,r,t){r=r||function(){},t=t||function(){};var n=ne.indexedDB();try{var o=n.open(ne.DB_NAME(),ne.DB_VERSION)}catch(e){return t(e)}o.onupgradeneeded=function(){m("creating db"),o.result.createObjectStore(ne.DB_STORE_NAME)},o.onsuccess=function(){var n=o.result.transaction([ne.DB_STORE_NAME],"readwrite"),i=n.objectStore(ne.DB_STORE_NAME),a=0,s=0,u=e.length;function c(){0==s?r():t()}e.forEach(function(e){var r=i.put(ne.analyzePath(e).object.contents,e);r.onsuccess=function(){++a+s==u&&c()},r.onerror=function(){a+ ++s==u&&c()}}),n.onerror=t},o.onerror=t},loadFilesFromDB:function(e,r,t){r=r||function(){},t=t||function(){};var n=ne.indexedDB();try{var o=n.open(ne.DB_NAME(),ne.DB_VERSION)}catch(e){return t(e)}o.onupgradeneeded=t,o.onsuccess=function(){var n=o.result;try{var i=n.transaction([ne.DB_STORE_NAME],"readonly")}catch(e){return void t(e)}var a=i.objectStore(ne.DB_STORE_NAME),s=0,u=0,c=e.length;function l(){0==u?r():t()}e.forEach(function(e){var r=a.get(e);r.onsuccess=function(){ne.analyzePath(e).exists&&ne.unlink(e),ne.createDataFile(J.dirname(e),J.basename(e),r.result,!0,!0,!0),++s+u==c&&l()},r.onerror=function(){s+ ++u==c&&l()}}),i.onerror=t},o.onerror=t}},oe={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,r){if("/"!==r[0]){var t;if(-100===e)t=ne.cwd();else{var n=ne.getStream(e);if(!n)throw new ne.ErrnoError(8);t=n.path}r=J.join2(t,r)}return r},doStat:function(e,r,t){try{var n=e(r)}catch(e){if(e&&e.node&&J.normalize(r)!==J.normalize(ne.getPath(e.node)))return-54;throw e}return A[t>>2]=n.dev,A[t+4>>2]=0,A[t+8>>2]=n.ino,A[t+12>>2]=n.mode,A[t+16>>2]=n.nlink,A[t+20>>2]=n.uid,A[t+24>>2]=n.gid,A[t+28>>2]=n.rdev,A[t+32>>2]=0,G=[n.size>>>0,(X=n.size,+Math.abs(X)>=1?X>0?(0|Math.min(+Math.floor(X/4294967296),4294967295))>>>0:~~+Math.ceil((X-+(~~X>>>0))/4294967296)>>>0:0)],A[t+40>>2]=G[0],A[t+44>>2]=G[1],A[t+48>>2]=4096,A[t+52>>2]=n.blocks,A[t+56>>2]=n.atime.getTime()/1e3|0,A[t+60>>2]=0,A[t+64>>2]=n.mtime.getTime()/1e3|0,A[t+68>>2]=0,A[t+72>>2]=n.ctime.getTime()/1e3|0,A[t+76>>2]=0,G=[n.ino>>>0,(X=n.ino,+Math.abs(X)>=1?X>0?(0|Math.min(+Math.floor(X/4294967296),4294967295))>>>0:~~+Math.ceil((X-+(~~X>>>0))/4294967296)>>>0:0)],A[t+80>>2]=G[0],A[t+84>>2]=G[1],0},doMsync:function(e,r,t,n,o){var i=S.slice(e,e+t);ne.msync(r,i,o,t,n)},doMkdir:function(e,r){return"/"===(e=J.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),ne.mkdir(e,r,0),0},doMknod:function(e,r,t){switch(61440&r){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return ne.mknod(e,r,t),0},doReadlink:function(e,r,t){if(t<=0)return-28;var n=ne.readlink(e),o=Math.min(t,b(n)),i=F[r+o];return k(n,S,r,t+1),F[r+o]=i,o},doAccess:function(e,r){if(-8&r)return-28;var t;if(!(t=ne.lookupPath(e,{follow:!0}).node))return-44;var n="";return 4&r&&(n+="r"),2&r&&(n+="w"),1&r&&(n+="x"),n&&ne.nodePermissions(t,n)?-2:0},doDup:function(e,r,t){var n=ne.getStream(t);return n&&ne.close(n),ne.open(e,r,0,t,t).fd},doReadv:function(e,r,t,n){for(var o=0,i=0;i<t;i++){var a=A[r+8*i>>2],s=A[r+(8*i+4)>>2],u=ne.read(e,F,a,s,n);if(u<0)return-1;if(o+=u,u<s)break}return o},doWritev:function(e,r,t,n){for(var o=0,i=0;i<t;i++){var a=A[r+8*i>>2],s=A[r+(8*i+4)>>2],u=ne.write(e,F,a,s,n);if(u<0)return-1;o+=u}return o},varargs:void 0,get:function(){return oe.varargs+=4,A[oe.varargs-4>>2]},getStr:function(e){return _(e)},getStreamFromFD:function(e){var r=ne.getStream(e);if(!r)throw new ne.ErrnoError(8);return r},get64:function(e,r){return e}};function ie(e){try{return w.grow(e-D.byteLength+65535>>>16),x(w.buffer),1}catch(e){}}var ae=function(e,r,t,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=ne.nextInode++,this.name=r,this.mode=t,this.node_ops={},this.stream_ops={},this.rdev=n};function se(e,r,t){var n=t>0?t:b(e)+1,o=new Array(n),i=k(e,o,0,o.length);return r&&(o.length=i),o}Object.defineProperties(ae.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return ne.isDir(this.mode)}},isDevice:{get:function(){return ne.isChrdev(this.mode)}}}),ne.FSNode=ae,ne.staticInit(),o.FS_createPath=ne.createPath,o.FS_createDataFile=ne.createDataFile,o.FS_createPreloadedFile=ne.createPreloadedFile,o.FS_createLazyFile=ne.createLazyFile,o.FS_createDevice=ne.createDevice,o.FS_unlink=ne.unlink,B.push({func:function(){le()}});var ue,ce={d:function(e,r,t){oe.varargs=t;try{var n=oe.getStreamFromFD(e);switch(r){case 0:return(o=oe.get())<0?-28:ne.open(n.path,n.flags,0,o).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:var o=oe.get();return n.flags|=o,0;case 12:return o=oe.get(),P[o+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return Z(28),-1;default:return-28}}catch(e){return void 0!==ne&&e instanceof ne.ErrnoError||H(e),-e.errno}},i:function(e,r,t){oe.varargs=t;try{var n=oe.getStreamFromFD(e);switch(r){case 21509:case 21505:return n.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-59;case 21519:if(!n.tty)return-59;var o=oe.get();return A[o>>2]=0,0;case 21520:return n.tty?-28:-59;case 21531:return o=oe.get(),ne.ioctl(n,r,o);case 21523:case 21524:return n.tty?0:-59;default:H("bad ioctl syscall "+r)}}catch(e){return void 0!==ne&&e instanceof ne.ErrnoError||H(e),-e.errno}},j:function(e,r,t){oe.varargs=t;try{var n=oe.getStr(e),o=oe.get();return ne.open(n,r,o).fd}catch(e){return void 0!==ne&&e instanceof ne.ErrnoError||H(e),-e.errno}},f:function(e,r,t){S.copyWithin(e,r,r+t)},g:function(e){e>>>=0;var r=S.length;if(e>2147483648)return!1;for(var t,n,o=1;o<=4;o*=2){var i=r*(1+.2/o);if(i=Math.min(i,e+100663296),ie(Math.min(2147483648,((t=Math.max(16777216,e,i))%(n=65536)>0&&(t+=n-t%n),t))))return!0}return!1},c:function(e){try{var r=oe.getStreamFromFD(e);return ne.close(r),0}catch(e){return void 0!==ne&&e instanceof ne.ErrnoError||H(e),e.errno}},h:function(e,r,t,n){try{var o=oe.getStreamFromFD(e),i=oe.doReadv(o,r,t);return A[n>>2]=i,0}catch(e){return void 0!==ne&&e instanceof ne.ErrnoError||H(e),e.errno}},e:function(e,r,t,n,o){try{var i=oe.getStreamFromFD(e),a=4294967296*t+(r>>>0);return a<=-9007199254740992||a>=9007199254740992?-61:(ne.llseek(i,a,n),G=[i.position>>>0,(X=i.position,+Math.abs(X)>=1?X>0?(0|Math.min(+Math.floor(X/4294967296),4294967295))>>>0:~~+Math.ceil((X-+(~~X>>>0))/4294967296)>>>0:0)],A[o>>2]=G[0],A[o+4>>2]=G[1],i.getdents&&0===a&&0===n&&(i.getdents=null),0)}catch(e){return void 0!==ne&&e instanceof ne.ErrnoError||H(e),e.errno}},b:function(e,r,t,n){try{var o=oe.getStreamFromFD(e),i=oe.doWritev(o,r,t);return A[n>>2]=i,0}catch(e){return void 0!==ne&&e instanceof ne.ErrnoError||H(e),e.errno}},a:w},le=(function(){var e={a:ce};function r(e,r){var t=e.exports;o.asm=t,M=o.asm.k,C()}function t(e){r(e.instance)}function i(r){return(h||!l&&!f||"function"!=typeof fetch?Promise.resolve().then(K):fetch(V,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+V+"'";return e.arrayBuffer()}).catch(function(){return K()})).then(function(r){return WebAssembly.instantiate(r,e)}).then(r,function(e){p("failed to asynchronously prepare wasm: "+e),H(e)})}if(I(),o.instantiateWasm)try{return o.instantiateWasm(e,r)}catch(e){return p("Module.instantiateWasm callback failed with error: "+e),!1}(h||"function"!=typeof WebAssembly.instantiateStreaming||U(V)||"function"!=typeof fetch?i(t):fetch(V,{credentials:"same-origin"}).then(function(r){return WebAssembly.instantiateStreaming(r,e).then(t,function(e){return p("wasm streaming compile failed: "+e),p("falling back to ArrayBuffer instantiation"),i(t)})})).catch(n)}(),o.___wasm_call_ctors=function(){return(le=o.___wasm_call_ctors=o.asm.l).apply(null,arguments)}),fe=o._malloc=function(){return(fe=o._malloc=o.asm.m).apply(null,arguments)},de=(o._free=function(){return(o._free=o.asm.n).apply(null,arguments)},o._mid_song_start=function(){return(o._mid_song_start=o.asm.o).apply(null,arguments)},o._mid_song_seek=function(){return(o._mid_song_seek=o.asm.p).apply(null,arguments)},o._mid_song_get_total_time=function(){return(o._mid_song_get_total_time=o.asm.q).apply(null,arguments)},o._mid_song_get_time=function(){return(o._mid_song_get_time=o.asm.r).apply(null,arguments)},o._mid_song_read_wave=function(){return(o._mid_song_read_wave=o.asm.s).apply(null,arguments)},o._mid_istream_open_mem=function(){return(o._mid_istream_open_mem=o.asm.t).apply(null,arguments)},o._mid_istream_close=function(){return(o._mid_istream_close=o.asm.u).apply(null,arguments)},o._mid_exit=function(){return(o._mid_exit=o.asm.v).apply(null,arguments)},o._mid_init=function(){return(o._mid_init=o.asm.w).apply(null,arguments)},o._mid_song_load=function(){return(o._mid_song_load=o.asm.x).apply(null,arguments)},o._mid_song_free=function(){return(o._mid_song_free=o.asm.y).apply(null,arguments)},o._mid_alloc_options=function(){return(o._mid_alloc_options=o.asm.z).apply(null,arguments)},o._mid_get_load_request_count=function(){return(o._mid_get_load_request_count=o.asm.A).apply(null,arguments)},o._mid_get_load_request=function(){return(o._mid_get_load_request=o.asm.B).apply(null,arguments)},o.___errno_location=function(){return(de=o.___errno_location=o.asm.C).apply(null,arguments)});function me(e){function r(){ue||(ue=!0,o.calledRun=!0,g||(!0,o.noFSInit||ne.init.initialized||ne.init(),ee.init(),$(B),ne.ignorePermissions=!1,$(z),t(o),o.onRuntimeInitialized&&o.onRuntimeInitialized(),function(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)e=o.postRun.shift(),N.unshift(e);var e;$(N)}()))}e=e||c,L>0||(!function(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)e=o.preRun.shift(),T.unshift(e);var e;$(T)}(),L>0||(o.setStatus?(o.setStatus("Running..."),setTimeout(function(){setTimeout(function(){o.setStatus("")},1),r()},1)):r()))}if(o.UTF8ToString=_,o.addRunDependency=I,o.removeRunDependency=C,o.FS_createPath=ne.createPath,o.FS_createDataFile=ne.createDataFile,o.FS_createPreloadedFile=ne.createPreloadedFile,o.FS_createLazyFile=ne.createLazyFile,o.FS_createDevice=ne.createDevice,o.FS_unlink=ne.unlink,o.FS=ne,j=function e(){ue||me(),ue||(j=e)},o.run=me,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return!0,me(),r.ready}}();"object"==typeof exports&&"object"==typeof module?module.exports=LibTimidity:"function"==typeof define&&define.amd?define([],function(){return LibTimidity}):"object"==typeof exports&&(exports.LibTimidity=LibTimidity);

},{}],8:[function(require,module,exports){
const Timidity=require("timidity"),Debug=require("debug"),debug=Debug("timidity"),debugVerbose=Debug("timidity:verbose"),defaultOpts={patUrl:"pa2/"};class ScriptoPlayer extends Timidity{constructor(e={}){super(e=Object.assign({},defaultOpts,e))}}module.exports=ScriptoPlayer;

},{"debug":1,"timidity":6}],9:[function(require,module,exports){
const ScriptoPlayer=require("./ScriptoPlayer");var player=null;window.ScriptoPlayer=function(){return player||(player=new ScriptoPlayer),player};

},{"./ScriptoPlayer":8}]},{},[9]);
